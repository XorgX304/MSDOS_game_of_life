_TEXT segment byte public 'CODE'
DGROUP	group	_DATA,_BSS
	assume	cs:_TEXT,ds:DGROUP,ss:DGROUP
_TEXT	ends
_DATA	segment word public 'DATA'
d@	label	byte
d@w	label	word
_DATA	ends
_BSS	segment word public 'BSS'
b@	label	byte
b@w	label	word
_BSS	ends
_DATA	segment word public 'DATA'
_ofs	label	dword
dd	0B000h:0000h, 0B200h:0000h, 0B400h:0000h, 0B600h:0000h
dd	0B000h:005Ah, 0B200h:005Ah, 0B400h:005Ah, 0B600h:005Ah
dd	0B000h:00B4h, 0B200h:00B4h, 0B400h:00B4h, 0B600h:00B4h
dd	0B000h:010Eh, 0B200h:010Eh, 0B400h:010Eh, 0B600h:010Eh
dd	0B000h:0168h, 0B200h:0168h, 0B400h:0168h, 0B600h:0168h
dd	0B000h:01C2h, 0B200h:01C2h, 0B400h:01C2h, 0B600h:01C2h
dd	0B000h:021Ch, 0B200h:021Ch, 0B400h:021Ch, 0B600h:021Ch
dd	0B000h:0276h, 0B200h:0276h, 0B400h:0276h, 0B600h:0276h
dd	0B000h:02D0h, 0B200h:02D0h, 0B400h:02D0h, 0B600h:02D0h
dd	0B000h:032Ah, 0B200h:032Ah, 0B400h:032Ah, 0B600h:032Ah
dd	0B000h:0384h, 0B200h:0384h, 0B400h:0384h, 0B600h:0384h
dd	0B000h:03DEh, 0B200h:03DEh, 0B400h:03DEh, 0B600h:03DEh
dd	0B000h:0438h, 0B200h:0438h, 0B400h:0438h, 0B600h:0438h
dd	0B000h:0492h, 0B200h:0492h, 0B400h:0492h, 0B600h:0492h
dd	0B000h:04ECh, 0B200h:04ECh, 0B400h:04ECh, 0B600h:04ECh
dd	0B000h:0546h, 0B200h:0546h, 0B400h:0546h, 0B600h:0546h
dd	0B000h:05A0h, 0B200h:05A0h, 0B400h:05A0h, 0B600h:05A0h
dd	0B000h:05FAh, 0B200h:05FAh, 0B400h:05FAh, 0B600h:05FAh
dd	0B000h:0654h, 0B200h:0654h, 0B400h:0654h, 0B600h:0654h
dd	0B000h:06AEh, 0B200h:06AEh, 0B400h:06AEh, 0B600h:06AEh
dd	0B000h:0708h, 0B200h:0708h, 0B400h:0708h, 0B600h:0708h
dd	0B000h:0762h, 0B200h:0762h, 0B400h:0762h, 0B600h:0762h
dd	0B000h:07BCh, 0B200h:07BCh, 0B400h:07BCh, 0B600h:07BCh
dd	0B000h:0816h, 0B200h:0816h, 0B400h:0816h, 0B600h:0816h
dd	0B000h:0870h, 0B200h:0870h, 0B400h:0870h, 0B600h:0870h
dd	0B000h:08CAh, 0B200h:08CAh, 0B400h:08CAh, 0B600h:08CAh
dd	0B000h:0924h, 0B200h:0924h, 0B400h:0924h, 0B600h:0924h
dd	0B000h:097Eh, 0B200h:097Eh, 0B400h:097Eh, 0B600h:097Eh
dd	0B000h:09D8h, 0B200h:09D8h, 0B400h:09D8h, 0B600h:09D8h
dd	0B000h:0A32h, 0B200h:0A32h, 0B400h:0A32h, 0B600h:0A32h
dd	0B000h:0A8Ch, 0B200h:0A8Ch, 0B400h:0A8Ch, 0B600h:0A8Ch
dd	0B000h:0AE6h, 0B200h:0AE6h, 0B400h:0AE6h, 0B600h:0AE6h
dd	0B000h:0B40h, 0B200h:0B40h, 0B400h:0B40h, 0B600h:0B40h
dd	0B000h:0B9Ah, 0B200h:0B9Ah, 0B400h:0B9Ah, 0B600h:0B9Ah
dd	0B000h:0BF4h, 0B200h:0BF4h, 0B400h:0BF4h, 0B600h:0BF4h
dd	0B000h:0C4Eh, 0B200h:0C4Eh, 0B400h:0C4Eh, 0B600h:0C4Eh
dd	0B000h:0CA8h, 0B200h:0CA8h, 0B400h:0CA8h, 0B600h:0CA8h
dd	0B000h:0D02h, 0B200h:0D02h, 0B400h:0D02h, 0B600h:0D02h
dd	0B000h:0D5Ch, 0B200h:0D5Ch, 0B400h:0D5Ch, 0B600h:0D5Ch
dd	0B000h:0DB6h, 0B200h:0DB6h, 0B400h:0DB6h, 0B600h:0DB6h
dd	0B000h:0E10h, 0B200h:0E10h, 0B400h:0E10h, 0B600h:0E10h
dd	0B000h:0E6Ah, 0B200h:0E6Ah, 0B400h:0E6Ah, 0B600h:0E6Ah
dd	0B000h:0EC4h, 0B200h:0EC4h, 0B400h:0EC4h, 0B600h:0EC4h
dd	0B000h:0F1Eh, 0B200h:0F1Eh, 0B400h:0F1Eh, 0B600h:0F1Eh
dd	0B000h:0F78h, 0B200h:0F78h, 0B400h:0F78h, 0B600h:0F78h
dd	0B000h:0FD2h, 0B200h:0FD2h, 0B400h:0FD2h, 0B600h:0FD2h
dd	0B000h:102Ch, 0B200h:102Ch, 0B400h:102Ch, 0B600h:102Ch
dd	0B000h:1086h, 0B200h:1086h, 0B400h:1086h, 0B600h:1086h
dd	0B000h:10E0h, 0B200h:10E0h, 0B400h:10E0h, 0B600h:10E0h
dd	0B000h:113Ah, 0B200h:113Ah, 0B400h:113Ah, 0B600h:113Ah
dd	0B000h:1194h, 0B200h:1194h, 0B400h:1194h, 0B600h:1194h
dd	0B000h:11EEh, 0B200h:11EEh, 0B400h:11EEh, 0B600h:11EEh
dd	0B000h:1248h, 0B200h:1248h, 0B400h:1248h, 0B600h:1248h
dd	0B000h:12A2h, 0B200h:12A2h, 0B400h:12A2h, 0B600h:12A2h
dd	0B000h:12FCh, 0B200h:12FCh, 0B400h:12FCh, 0B600h:12FCh
dd	0B000h:1356h, 0B200h:1356h, 0B400h:1356h, 0B600h:1356h
dd	0B000h:13B0h, 0B200h:13B0h, 0B400h:13B0h, 0B600h:13B0h
dd	0B000h:140Ah, 0B200h:140Ah, 0B400h:140Ah, 0B600h:140Ah
dd	0B000h:1464h, 0B200h:1464h, 0B400h:1464h, 0B600h:1464h
dd	0B000h:14BEh, 0B200h:14BEh, 0B400h:14BEh, 0B600h:14BEh
dd	0B000h:1518h, 0B200h:1518h, 0B400h:1518h, 0B600h:1518h
dd	0B000h:1572h, 0B200h:1572h, 0B400h:1572h, 0B600h:1572h
dd	0B000h:15CCh, 0B200h:15CCh, 0B400h:15CCh, 0B600h:15CCh
dd	0B000h:1626h, 0B200h:1626h, 0B400h:1626h, 0B600h:1626h
dd	0B000h:1680h, 0B200h:1680h, 0B400h:1680h, 0B600h:1680h
dd	0B000h:16DAh, 0B200h:16DAh, 0B400h:16DAh, 0B600h:16DAh
dd	0B000h:1734h, 0B200h:1734h, 0B400h:1734h, 0B600h:1734h
dd	0B000h:178Eh, 0B200h:178Eh, 0B400h:178Eh, 0B600h:178Eh
dd	0B000h:17E8h, 0B200h:17E8h, 0B400h:17E8h, 0B600h:17E8h
dd	0B000h:1842h, 0B200h:1842h, 0B400h:1842h, 0B600h:1842h
dd	0B000h:189Ch, 0B200h:189Ch, 0B400h:189Ch, 0B600h:189Ch
dd	0B000h:18F6h, 0B200h:18F6h, 0B400h:18F6h, 0B600h:18F6h
dd	0B000h:1950h, 0B200h:1950h, 0B400h:1950h, 0B600h:1950h
dd	0B000h:19AAh, 0B200h:19AAh, 0B400h:19AAh, 0B600h:19AAh
dd	0B000h:1A04h, 0B200h:1A04h, 0B400h:1A04h, 0B600h:1A04h
dd	0B000h:1A5Eh, 0B200h:1A5Eh, 0B400h:1A5Eh, 0B600h:1A5Eh
dd	0B000h:1AB8h, 0B200h:1AB8h, 0B400h:1AB8h, 0B600h:1AB8h
dd	0B000h:1B12h, 0B200h:1B12h, 0B400h:1B12h, 0B600h:1B12h
dd	0B000h:1B6Ch, 0B200h:1B6Ch, 0B400h:1B6Ch, 0B600h:1B6Ch
dd	0B000h:1BC6h, 0B200h:1BC6h, 0B400h:1BC6h, 0B600h:1BC6h
dd	0B000h:1C20h, 0B200h:1C20h, 0B400h:1C20h, 0B600h:1C20h
dd	0B000h:1C7Ah, 0B200h:1C7Ah, 0B400h:1C7Ah, 0B600h:1C7Ah
dd	0B000h:1CD4h, 0B200h:1CD4h, 0B400h:1CD4h, 0B600h:1CD4h
dd	0B000h:1D2Eh, 0B200h:1D2Eh, 0B400h:1D2Eh, 0B600h:1D2Eh
dd	0B000h:1D88h, 0B200h:1D88h, 0B400h:1D88h, 0B600h:1D88h
dd	0B000h:1DE2h, 0B200h:1DE2h, 0B400h:1DE2h, 0B600h:1DE2h
dd	0B000h:1E3Ch, 0B200h:1E3Ch, 0B400h:1E3Ch, 0B600h:1E3Ch
dd	0B000h:1E96h, 0B200h:1E96h, 0B400h:1E96h, 0B600h:1E96h
_ormask label	byte
db	128,64,32,16,8,4,2,1
_andmask label	byte
db	127,191,223,239,247,251,253,254
_DATA	ends
_TEXT	segment	byte public 'CODE'
; bp+4	-> x
; bp+6	-> y
_setdot  proc	 near
	push	bp
	push	si
	push	di
	mov	bp,sp
	mov	si,[bp+10]
	shl	si,1
	shl	si,1
	les	bx,_ofs[si]
	mov	di,[bp+8]
	mov	ax,di
	shr	di,1
	shr	di,1
	shr	di,1
	add	di,bx
	and	ax,7
	mov	bx,offset _ormask
	xlat
	or	es:[di],al
	pop	di
	pop	si
	pop	bp
	ret
_setdot  endp

_cleardot  proc    near
	push	bp
	push	si
	push	di
	mov	bp,sp
	mov	si,[bp+10]
	shl	si,1
	shl	si,1
	les	bx,_ofs[si]
	mov	di,[bp+8]
	mov	ax,di
	shr	di,1
	shr	di,1
	shr	di,1
	add	di,bx
	and	ax,7
	mov	bx,offset _andmask
	xlat
	and	es:[di],al
	pop	di
	pop	si
	pop	bp
	ret
_cleardot  endp
_TEXT	ends
	public	_setdot
	public	_cleardot
	end
